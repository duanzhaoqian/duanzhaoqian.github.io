<!DOCTYPE html>
<html lang="zh-CN,en,default">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 4.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css">


<script id="hexo-configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    hostname: new URL('https://duanzhaoqian.site').hostname,
    root: '/',
    scheme: 'Gemini',
    version: '7.7.0',
    exturl: false,
    sidebar: {"position":"left","display":"always","padding":18,"offset":12,"onmobile":false,"b2t":false,"scrollpercent":false,"dimmer":false},
    copycode: {"enable":false,"show_result":false,"style":null},
    back2top: {"enable":true,"sidebar":false,"scrollpercent":false},
    bookmark: {"enable":false,"color":"#222","save":"auto"},
    fancybox: false,
    mediumzoom: false,
    lazyload: false,
    pangu: false,
    comments: {"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},
    algolia: {
      appID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    localsearch: {"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},
    path: 'search.xml',
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}
  };
</script>

  <meta name="description" content="linux 用户命令">
<meta property="og:type" content="article">
<meta property="og:title" content="linux 用户命令">
<meta property="og:url" content="https://duanzhaoqian.site/2016/05/23/Linux%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86.html">
<meta property="og:site_name" content="Duan Blog">
<meta property="og:description" content="linux 用户命令">
<meta property="og:locale" content="zh_CN">
<meta property="article:published_time" content="2016-05-22T16:00:00.000Z">
<meta property="article:modified_time" content="2020-01-04T12:09:11.236Z">
<meta property="article:author" content="Duan Zhao Qian">
<meta property="article:tag" content="linux">
<meta property="article:tag" content="shell">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://duanzhaoqian.site/2016/05/23/Linux%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86.html">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome: false,
    isPost: true
  };
</script>

  <title>linux 用户命令 | Duan Blog</title>
  


  <script>
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?72a166bd899bb0f2660b2c0f9d302b3d";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-meta">

    <div>
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Duan Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
  </div>

  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>
</div>


<nav class="site-nav">
  
  <ul id="menu" class="menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-fw fa-sitemap"></i>站点地图</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索
        </a>
      </li>
  </ul>

</nav>
  <div class="site-search">
    <div class="popup search-popup">
    <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocorrect="off" autocapitalize="none"
           placeholder="搜索..." spellcheck="false"
           type="text" id="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result"></div>

</div>
<div class="search-pop-overlay"></div>

  </div>
</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content">
            

  <div class="posts-expand">
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block " lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://duanzhaoqian.site/2016/05/23/Linux%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Duan Zhao Qian">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Duan Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          linux 用户命令
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>

              <time title="创建时间：2016-05-23 00:00:00" itemprop="dateCreated datePublished" datetime="2016-05-23T00:00:00+08:00">2016-05-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="fa fa-calendar-check-o"></i>
                </span>
                <span class="post-meta-item-text">更新于</span>
                <time title="修改时间：2020-01-04 20:09:11" itemprop="dateModified" datetime="2020-01-04T20:09:11+08:00">2020-01-04</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index">
                    <span itemprop="name">Linux</span>
                  </a>
                </span>
            </span>

          
            <span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display: none;">
              <span class="post-meta-item-icon">
                <i class="fa fa-eye"></i>
              </span>
              <span class="post-meta-item-text">阅读次数：</span>
              <span id="busuanzi_value_page_pv"></span>
            </span><br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="fa fa-file-word-o"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>14k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="fa fa-clock-o"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>13 分钟</span>
            </span>
            <div class="post-description">linux 用户命令</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Linux-用户和用户组管理"><a href="#Linux-用户和用户组管理" class="headerlink" title="Linux 用户和用户组管理"></a>Linux 用户和用户组管理</h1><!--
create time: 2016-05-23 15:05:01
Author: <段朝骞>

This file is created by Marboo<https://marboo.io> template file $MARBOO_HOME/.media/starts/default.md
本文件由 Marboo<https://marboo.io> 模板文件 $MARBOO_HOME/.media/starts/default.md 创建
-->

<p>Linux 是个多用户多任务的分时操作系统，所有一个要使用系统资源的用户都必须先向系统管理员申请一个账号，然后以这个账号的身份进入系统。用户的账号一方面能帮助系统管理员对使用系统的用户进行跟踪，并控制他们对系统资源的访问；另一方面也能帮助用户组织文件，并为用户提供安全性保护。每个用户账号都拥有一个惟一的用户名和用户口令。用户在登录时键入正确的用户名和口令后，才能进入系统和自己的主目录。<br>实现用户账号的管理，要完成的工作主要有如下几个方面：<br>a.用户账号的添加、删除和修改。<br>b.用户口令的管理。<br>c.用户组的管理。</p>
<h2 id="Linux-用户账号的管理"><a href="#Linux-用户账号的管理" class="headerlink" title="Linux 用户账号的管理"></a>Linux 用户账号的管理</h2><p>用户账号的管理主要涉及到用户账号的添加、删除和修改。</p>
<p>添加用户账号就是在系统中创建一个新账号，然后为新账号分配用户号、用户组、主目录和登录 Shell 等资源。刚添加的账号是被锁定的，无法使用。</p>
<ol>
<li><p><strong>useradd</strong></p>
<pre><code>    添加新的用户账号使用useradd命令，语法如下:
    useradd 选项 用户名
    其中各选项含义如下：

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">-c comment 指定一段注释性描述。</span><br><span class="line">-d 目录 指定用户主目录，如果此目录不存在，则同时使用-m选项，能创建主目录。</span><br><span class="line">-g 用户组 指定用户所属的用户组。</span><br><span class="line">-G 用户组,用户组 指定用户所属的附加组。</span><br><span class="line">-s Shell文件 指定用户的登录Shell。</span><br><span class="line">-u 用户号 指定用户的用户号，如果同时有-o选项，则能重复使用其他用户的标识号。</span><br><span class="line">-p 这个命令是需求提供md5码的加密口令，普通数字是不行的。</span><br></pre></td></tr></table></figure>

    用户名 指定新账号的登录名。

    ex:
    例1：

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># useradd -d &#x2F;usr&#x2F;sam -m sam</span><br></pre></td></tr></table></figure>
    此命令创建了一个用户sam，其中-d和-m选项用来为登录名sam产生一个主目录/usr/sam（/usr为默认的用户主目录所在的父目录）。
    例2：

    <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># useradd -s &#x2F;bin&#x2F;sh -g group -G adm,root gem</span><br></pre></td></tr></table></figure>

    此命令新建了一个用户gem，该用户的登录Shell是/bin/sh，他属于group用户组，同时又属于adm和root用户组，其中group用户组是其主组。

    这里可能新建组：groupadd group 及 groupadd adm

    增加用户账号就是在/etc/passwd文件中为新用户增加一条记录，同时更新其他系统文件，如/etc/shadow，/etc/group等。

    Linux提供了集成的系统管理工具userconf，他能用来对用户账号进行统一管理。

    注：

用户帐户本身在 /etc/passwd 中定义。Linux 系统包含一个 /etc/passwd 的同伴文件，叫做 /etc/shadow。该文件不像 /etc/passwd，只有对于 root 用户来说是可读的，并且包含加密的密码信息。我们来看一看 /etc/shadow 的一个样本行：</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1$1234567890123456789012345678901:11664:0:-1:-1:-1:-1:0</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">root:$6$kVbUQRog2BVAL2s5$3bTISySSa5Qi2kOnyiF4ION783UuCCk4Lj0oXuMoiwU9TkF5EcfhCB4qp3eoCAGzd.jgY6KmhqGdyNThrG8U81:16939:0:99999:7:::</span><br></pre></td></tr></table></figure>

<p>每一行给一个特别帐户定义密码信息，同样的，每个字段用 : 隔开。第一个字段定义和这个 shadow 条目相关联的特别用户帐户。第二个字段包含一个加密的密码。其余的字段在下表中描述：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">字段 3 自 1&#x2F;1&#x2F;1970 起，密码被修改的天数</span><br><span class="line">字段 4 密码将被允许修改之前的天数（0 表示“可在所有时间修改”）</span><br><span class="line">字段 5 系统将强制用户修改为新密码之前的天数（1 表示“永远都不能修改”）</span><br><span class="line">字段 6 密码过期之前，用户将被警告过期的天数（-1 表示“没有警告”）</span><br><span class="line">字段 7 密码过期之后，系统自动禁用帐户的天数（-1 表示“永远不会禁用”）</span><br><span class="line">字段 8 该帐户被禁用的天数（-1 表示“该帐户被启用”） 字段9保留供将来使用</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>userdel</strong></p>
<p>删除帐号</p>
<p>如果一个用户账号不再使用，能从系统中删除。删除用户账号就是要将/etc/passwd 等系统文件中的该用户记录删除，必要时还要删除用户的主目录。删除一个已有的用户账号使用 userdel 命令，格式如下：<br>代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">userdel 选项 用户名</span><br></pre></td></tr></table></figure>

<p>常用的选项是-r，他的作用是把用户的主目录一起删除。<br>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># userdel -r sam</span><br></pre></td></tr></table></figure>

<p>此命令删除用户 sam 在系统文件（主要是/etc/passwd，/etc/shadow，/etc/group 等）中的记录，同时删除用户的主目录。</p>
</li>
<li><p><strong>usermod</strong></p>
<p>修改帐号</p>
<p>修改用户账号就是根据实际情况更改用户(<code>chgrp</code>是针对文件而言)的有关属性，如用户号、主目录、用户组、登录 Shell 等。<br>修改已有用户的信息使用 usermod 命令，格式如下：<br>代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod 选项 用户名[只有终极管理员才有权限修改帐号名，如果用sudo命令来对普通帐号授权也行]</span><br></pre></td></tr></table></figure>

<p>常用的选项包括-c,-d,-m,-g,-G,-s,-u,-o 等，这些选项的意义和 useradd 命令中的相同，能为用户指定新的资源值。另外，有些系统能使用如下选项：<br>代码:<br>-l 新用户名<br>这个选项指定一个新的账号，即将原来的用户名改为新的用户名。<br>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># usermod -s &#x2F;bin&#x2F;ksh -d &#x2F;home&#x2F;z -g developer sam</span><br></pre></td></tr></table></figure>

<p>此命令将用户 sam 的登录 Shell 修改为 ksh，主目录改为/home/z，用户组改为 developer。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#usermod zte1 -g cheng</span><br></pre></td></tr></table></figure>

<p>此命令是改动用户 zte1 所属的组为 cheng 这个组</p>
</li>
<li><p><strong>id</strong></p>
<pre><code>    查看帐号属性

    格式： id user1

    显示user1的uid和gid ,缺省为当前用户的id信息
ex:

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zte@SMPS-WEB1:&#x2F;home&gt; id zte</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uid&#x3D;1011(zte) gid&#x3D;100(users) groups&#x3D;100(users),14 (uucp),16(dialout),17(audio),33(video)</span><br></pre></td></tr></table></figure></code></pre></li>
</ol>
<pre><code>groups user1 显示用户 user1 所在的组,缺省为当前用户所在的组信息</code></pre><h2 id="Linux-用户口令的管理"><a href="#Linux-用户口令的管理" class="headerlink" title="Linux 用户口令的管理"></a>Linux 用户口令的管理</h2><p>用户管理的一项重要内容是用户口令的管理。用户账号刚创建时没有口令，是被系统锁定的，无法使用，必须为其指定口令后才能使用，即使是空口令。<br>指定和修改用户口令的 Shell 命令是 passwd。终极用户能为自己和其他用户指定口令，普通用户只能修改自己的口令。命令的格式为：<br>代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">passwd 选项 用户名</span><br><span class="line">可使用的选项：</span><br><span class="line">-l 锁定口令，即禁用账号。</span><br><span class="line">-u 口令解锁。</span><br><span class="line">-d 使账号无口令。</span><br><span class="line">-f 强迫用户下次登录时修改口令。</span><br></pre></td></tr></table></figure>

<p>如果默认用户名，则修改当前用户的口令。<br>例如：假设当前用户是 sam，则下面的命令修改该用户自己的口令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ passwd</span><br><span class="line">Old password:******</span><br><span class="line">New password:*******</span><br><span class="line">Re-enter new password:*******</span><br></pre></td></tr></table></figure>

<p>如果是终极用户，能用下列形式指定任意用户的口令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># passwd sam</span><br><span class="line">New password:*******</span><br><span class="line">Re-enter new password:*******</span><br></pre></td></tr></table></figure>

<p>普通用户修改自己的口令时，passwd 命令会先询问原口令，验证后再需求用户输入两遍新口令，如果两次输入的口令一致，则将这个口令指定给用户；而终极 用户为用户指定口令时，就不必知道原口令。为了安全起见，用户应该选择比较复杂的口令，最佳使用不少于 8 位的口令，口令中包含有大写、小写字母和数字，并 且应该和姓名、生日等不相同。</p>
<p>为用户指定空口令时，执行下列形式的命令：<br>代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># passwd -d sam</span><br></pre></td></tr></table></figure>

<p>此命令将用户 sam 的口令删除，这样用户 sam 下一次登录时，系统就不再询问口令。</p>
<p>passwd 命令还能用-l(lock)选项锁定某一用户，使其不能登录，例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># passwd -l sam</span><br></pre></td></tr></table></figure>

<h2 id="Linux-用户组的管理"><a href="#Linux-用户组的管理" class="headerlink" title="Linux 用户组的管理"></a>Linux 用户组的管理</h2><p>每个用户都有一个用户组，系统能对一个用户组中的所有用户进行集中管理。不同 Linux 系统对用户组的规定有所不同，如 Linux 下的用户属于和他同名的用户组，这个用户组在创建用户时同时创建。用户组的管理涉及用户组的添加、删除和修改。组的增加、删除和修改实际上就对/etc/group 文件的更新。</p>
<p>用户组（group）就是具有相同特征的用户（user）的集合体；比如有时我们要让多个用户具有相同的权限，比如查看、修改某一文件或执行某个命令，这时我们需要用户组，我们把用户都定义到同一用户组，我们通过修改文件或目录的权限，让用户组具有一定的操作权限，这样用户组下的用户对该文件或目录都具有相同的权限，这是我们通过定义组和修改文件的权限来实现的；</p>
<p>举例：<br>我们为了让一些用户有权限查看某一文件，比如是个时间表，而编写时间表的人要具有读写执行的权限，我们想让一些用户知道这个时间表的内容，而不让他们修 改，所以我们能把这些用户都划到一个组（用<code>chgrp</code>命令），然后来修改这个文件（用 chmod 命令）的权限，让用户组可读（用 chgrp 命令将此文件归 属于这个组），这样用户组下面的每个用户都是可读的，其他用户是无法访问的。</p>
<p>1、增加一个新的用户组使用 groupadd 命令。格式如下：<br>代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupadd 选项 用户组[用户组添加后，将用户进行组赋予用chown和chgrp指令]</span><br></pre></td></tr></table></figure>

<p>能使用的选项有：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">-g GID 指定新用户组的组标识号（GID）。</span><br><span class="line">-o 一般和-g选项同时使用，表示新用户组的GID能和系统已有用户组的GID相同。</span><br></pre></td></tr></table></figure>

<p>例 1：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># groupadd group1</span><br></pre></td></tr></table></figure>

<p>此命令向系统中增加了一个新组 group1，新组的组标识号是在当前已有的最大组标识号的基础上加 1。<br>例 2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># groupadd -g 101 group2</span><br></pre></td></tr></table></figure>

<p>此命令向系统中增加了一个新组 group2，同时指定新组的组标识号是 101。<br>2、如果要删除一个已有的用户组，使用 groupdel 命令，格式如下：<br>代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupdel 用户组</span><br></pre></td></tr></table></figure>

<p>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># groupdel group1</span><br></pre></td></tr></table></figure>

<p>此命令从系统中删除组 group1。</p>
<p>3、修改用户组的属性使用 groupmod 命令。其语法如下：<br>代码:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">groupmod 选项 用户组</span><br></pre></td></tr></table></figure>

<p>常用的选项有：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-g GID 为用户组指定新的组标识号。</span><br><span class="line">-o 和-g选项同时使用，用户组的新GID能和系统已有用户组的GID相同。</span><br><span class="line">-n 新用户组 将用户组的名字改为新名字</span><br></pre></td></tr></table></figure>

<p>例 1：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># groupmod -g 102 group2</span><br></pre></td></tr></table></figure>

<p>此命令将组 group2 的组标识号修改为 102。<br>例 2：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"># groupmod -g 10000 -n group3 group2</span><br></pre></td></tr></table></figure>

<p>此命令将组 group2 的标识号改为 10000，组名修改为 group3。</p>
<p>4、如果一个用户同时属于多个用户组，那么用户能在用户组之间转换，以便具有其他用户组的权限。用户能在登录后，使用命令 newgrp 转换到其他用户组，这个命令的参数就是目的用户组。<br>例如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ newgrp root</span><br></pre></td></tr></table></figure>

<p>这条命令将当前用户转换到 root 用户组，前提条件是 root 用户组确实是该用户的主组或附加组。类似于用户账号的管理，用户组的管理也能通过集成的系统管理工具来完成。</p>
<h2 id="和用户账号有关的系统文件"><a href="#和用户账号有关的系统文件" class="headerlink" title="和用户账号有关的系统文件"></a>和用户账号有关的系统文件</h2><p>完成用户管理的工作有许多种方法，不过每一种方法实际上都是对有关的系统文件进行修改。和用户和用户组相关的信息都存放在一些系统文件中，这些文件包括/etc/passwd，/etc/shadow，/etc/group 等。下面分别介绍这些文件的内容。</p>
<p>1、/etc/passwd 文件是用户管理工作涉及的最重要的一个文件。Linux 系统中的每个用户都在/etc/passwd 文件中有一个对应的记录行，他记录了这个用户的一些基本属性。这个文件对所有用户都是可读的。他的内容类似下面的例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">＃ cat &#x2F;etc&#x2F;passwd</span><br><span class="line">root:x:0:0:Superuser:&#x2F;:</span><br><span class="line">daemon:x:1:1:System daemons:&#x2F;etc:</span><br><span class="line">bin:x:2:2:Owner of system commands:&#x2F;bin:</span><br><span class="line">sys:x:3:3:Owner of system files:&#x2F;usr&#x2F;sys:</span><br><span class="line">adm:x:4:4:System accounting:&#x2F;usr&#x2F;adm:</span><br><span class="line">uucp:x:5:5:UUCP administrator:&#x2F;usr&#x2F;lib&#x2F;uucp:</span><br><span class="line">auth:x:7:21:Authentication administrator:&#x2F;tcb&#x2F;files&#x2F;auth:</span><br><span class="line">cron:x:9:16:Cron daemon:&#x2F;usr&#x2F;spool&#x2F;cron:</span><br><span class="line">listen:x:37:4:Network daemon:&#x2F;usr&#x2F;net&#x2F;nls:</span><br><span class="line">sam:x:200:50:Sam san:&#x2F;usr&#x2F;sam:&#x2F;bin&#x2F;sh</span><br></pre></td></tr></table></figure>

<p>从上面的例子我们能看到，/etc/passwd 中一行记录对应着一个用户，每行记录又被冒号分隔为 7 个字段，其格式和具体含义如下：<br>代码:<br>用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录 Shell</p>
<p>（1）“用户名”是代表用户账号的字符串。通常长度不超过 8 个字符，并且由大小写字母和/或数字组成。登录名中不能有冒号，因为冒号在这里是分隔符。为了兼容起见，登录名中最佳不要包含点字符“.”，并且不使用连字符“-”和加号“+”打头。<br>（2） “口令”，一些系统中存放着加密后的用户口令，虽然这个字段存放的只是用户口令的加密串，不是明文，不过由于/etc/passwd 文件对所有用户都可读，所以这仍是个安全隐患。因此，目前许多 Linux 系统都使用了 shadow 技术，把真正的加密后的用户口令字存放到/etc/shadow 文件中，而在/etc/passwd 文件的口令字段中只存放一个特别的字符，例如“x”或“*”。<br>（3）“用户标识号”是个整数，系统内部用他来标识用户。一般情况下他和用户名是一一对应的。如果几个用户名对应的用户标 识号是相同的，系统内部将把他们视为同一个用户，不过他们能有不同的口令、不同的主目录及不同的登录 Shell 等。通常用户标识号的取值范围是 0 ～ 65535。0 是终极用户 root 的标识号，1 ～ 99 由系统保留，作为管理账号，普通用户的标识号从 100 开始。在 Linux 系统中，这个界限是 500。<br>（4）“组标识号”字段记录的是用户所属的用户组。他对应着/etc/group 文件中的一条记录。<br>（5） “注释性描述”字段记录着用户的一些个人情况，例如用户的真实姓名、电话、地址等，这个字段并没有什么实际的用途。在不同的 Linux 系统中，这个字段的 格式并没有统一。在许多 Linux 系统中，这个字段存放的是一段任意的注释性描述文字，用做 finger 命令的输出。<br>（6）“主目录”，也就是用户的起始工作目录，他是用户在登录到系统之后所处的目录。在大多数系统中，各用户的主目录都被组织在同一个特定的目录下，而用 户主目录的名称就是该用户的登录名。各用户对自己的主目录有读、写、执行（搜索）权限，其他用户对此目录的访问权限则根据具体情况设置。<br>（7）用户登录后，要启动一个进程，负责将用户的操作传给内核，这个进程是用户登录到系统后运行的命令解释器或某个特定的程式，即 Shell。Shell 是用户和 Linux 系统之间的接口。 Linux 的 Shell 有许多种，每种都有不同的特点。常用的有 sh(Bourne Shell),csh(C Shell),ksh(Korn Shell),tcsh(TENEX/TOPS-20 type C Shell),bash(Bourne Again Shell)等。系统管理员能根据系统情况和用户习惯为用户指定某个 Shell。如果不指定 Shell，那么系统使用 sh 为默认的登录 Shell，即这个 字段的值为/bin/sh。<br>用户的登录 Shell 也能指定为某个特定的程式（此程式不是个命令解释器）。利用这一特点，我们能限制用户只能运行指定的应用程式，在该应用程式运行结束 后，用户就自动退出了系统。有些 Linux 系统需求只有那些在系统中登记了的程式才能出目前这个字段中。系统中有一类用户称为伪用户（psuedo users），这些用户在/etc/passwd 文件中也占有一条记录，不过不能登录，因为他们的登录 Shell 为空。他们的存在主要是方便系统管理，满 足相应的系统进程对文件属主的需求。常见的伪用户如下所示。<br>伪 用 户 含 义<br>bin 拥有可执行的用户命令文件<br>sys 拥有系统文件<br>adm 拥有帐户文件<br>uucp UUCP 使用<br>lp lp 或 lpd 子系统使用<br>nobody NFS 使用<br>除了上面列出的伪用户外，更有许多标准的伪用户，例如：audit,cron,mail,usenet 等，他们也都各自为相关的进程和文件所需要。由于 /etc/passwd 文件是所有用户都可读的，如果用户的密码太简单或规律比较明显的话，一台普通的计算机就能够非常容易地将他破解，因此对安全性需求较高的 Linux 系统都把加密后的口令字分离出来，独立存放在一个文件中，这个文件是/etc/shadow 文件。只有终极用户才拥有该文件读权限，这就确保了用户密码的安全性。</p>
<p>2、/etc/shadow 中的记录行和/etc/passwd 中的一一对应，他由 pwconv 命令根据/etc/passwd 中的数据自动产生。他的文件格式和/etc/passwd 类似，由若干个字段组成，字段之间用“:”隔开。这些字段是：<br>登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志<br>（1）“登录名”是和/etc/passwd 文件中的登录名相一致的用户账号<br>（2）“口令”字段存放的是加密后的用户口令字，长度为 13 个字符。如果为空，则对应用户没有口令，登录时不必口令；如果含有不属于集合{ ./0-9A-Za-z }中的字符，则对应的用户不能登录。<br>（3）“最后一次修改时间”表示的是从某个时刻起，到用户最后一次修改口令时的天数。时间起点对不同的系统可能不相同。例如在 SCO Linux 中，这个时间起点是 1970 年 1 月 1 日。<br>（4）“最小时间间隔”指的是两次修改口令之间所需的最小天数。<br>（5）“最大时间间隔”指的是口令保持有效的最大天数。<br>（6）“警告时间”字段表示的是从系统开始警告用户到用户密码正式失效之间的天数。<br>（7）“不活动时间”表示的是用户没有登录活动但账号仍能保持有效的最大天数。<br>（8）“失效时间”字段给出的是个绝对的天数，如果使用了这个字段，那么就给出相应账号的生存期。期满后，该账号就不再是个合法的账号，也就不能再用来登录了。<br>下面是/etc/shadow 的一个例子：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">daemon:*::0:0::::</span><br><span class="line">bin:*::0:0::::</span><br><span class="line">sys:*::0:0::::</span><br><span class="line">adm:*::0:0::::</span><br><span class="line">uucp:*::0:0::::</span><br><span class="line">nuucp:*::0:0::::</span><br><span class="line">auth:*::0:0::::</span><br><span class="line">cron:*::0:0::::</span><br><span class="line">listen:*::0:0::::</span><br><span class="line">lp:*::0:0::::</span><br><span class="line">sam:EkdiSECLWPdSa:9740:0:0::::</span><br></pre></td></tr></table></figure>

<p>3、用户组的所有信息都存放在/etc/group 文件中。<br>将用户分组是 Linux 系统中对用户进行管理及控制访问权限的一种手段。每个用户都属于某个用户组；一个组中能有多个用户，一个用户也能属于不同的组。当 一个用户同时是多个组中的成员时，在/etc/passwd 文件中记录的是用户所属的主组，也就是登录时所属的默认组，而其他组称为附加组。用户要访问属 于附加组的文件时，必须首先使用 newgrp 命令使自己成为所要访问的组中的成员。用户组的所有信息都存放在/etc/group 文件中。此文件的格式也 类似于/etc/passwd 文件，由冒号隔开若干个字段，这些字段有：<br>组名:口令:组标识号:组内用户列表<br>（1）“组名”是用户组的名称，由字母或数字构成。和/etc/passwd 中的登录名相同，组名不应重复。<br>（2）“口令”字段存放的是用户组加密后的口令字。一般 Linux 系统的用户组都没有口令，即这个字段一般为空，或是*。<br>（3）“组标识号”和用户标识号类似，也是个整数，被系统内部用来标识组。<br>（4）“组内用户列表”是属于这个组的所有用户的列表，不同用户之间用逗号“,”分隔。这个用户组可能是用户的主组，也可能是附加组。<br>/etc/group 文件的一个例子如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># cat &#x2F;etc&#x2F;group</span><br><span class="line">root::0:root</span><br><span class="line">bin::2:root,bin</span><br><span class="line">sys::3:root,uucp</span><br><span class="line">adm::4:root,adm</span><br><span class="line">daemon::5:root,daemon</span><br><span class="line">lp::7:root,lp</span><br><span class="line">users::20:root,sam</span><br></pre></td></tr></table></figure>

<h2 id="su"><a href="#su" class="headerlink" title="su"></a>su</h2><p>su 命令这个命令非常重要，它可以让一个普通用户拥有超级用户或其他用户的权限，也可以让超级用户以普通用户的身份做一些事情。普通用户使用这个命令时必须有超级用户或其他用户的口令。如要离开当前用户的身份，可以键入 exit 命令，su 命令的一般形式为：<br>su – 用户名</p>
<h2 id="赋予普通用户特别权限-sudo-命令"><a href="#赋予普通用户特别权限-sudo-命令" class="headerlink" title="赋予普通用户特别权限[sudo 命令]"></a>赋予普通用户特别权限[sudo 命令]</h2><p>在 Linux 系统中，管理员往往不止一人，若每位管理员都用 root 身份进行管理工作，根本无法弄清晰谁该做什么。所以最佳的方式是：管理员创建一些普通用户，分配一部分系统管理工作给他们。<br>由于 su 对转换到终极权限用户 root 后，权限的无限制性，所以 su 并不能担任多个管理员所管理的系统。如果用 su 来转换到终极用户来管理系统，也不能明确哪些工作是由哪个管理员进行的操作。特别是对于服务器的 管理有多人参和管理时，最佳是针对每个管理员的技术特长和管理范围，并且有针对性的下放给权限，并且约定其使用哪些工具来完成和其相关的工作，这时我们就 有必要用到 sudo。通过 sudo，我们能把某些终极权限有针对性的下放，并且不必普通用户知道 root 密码，所以 sudo 相对于权限无限制性的 su 来说，还是比较安全的，所以 sudo 也能被称为受限制的 su ；另外 sudo 是需要授权许可的，所以也被称为授权许可的 su；sudo 执行命令的流程是当前用户转换到 root（或其他指定转换到的用户），然后以 root（或其他指定的转换到的用户）身份执行命令，执行完成后，直接退回到当前用户；而这些的前提是要通过 sudo 的设置文件/etc/sudoers 来进行授权；<br>我们不能使用 su 让他们直接变成 root，因为这些用户都必须知道 root 的密码，这种方法非常不安全，而且也不符合我们的分工需求。一般的做法是利用权限的设置，依工作性质分类，让特别身份的用户成为同一个工作组，并设置工作组权限。例如：要 wwwadm 这位用户负责管理网站数据，一般 Apache Web Server 的进程 httpd 的所有者是 www，你能设置用户 wwwadm 和 www 为同一工作组，并设置 Apache 默认存放网页录 /usr/local/httpd/htdocs 的工作组权限为可读、可写、可执行，这样属于此工作组的每位用户就能进行网页的管理了。<br>但这并不是最佳的解决办法，例如管理员想授予一个普通用户关机的权限，这时使用上述的办法就不是非常最佳。这时你也许会想，我只让这个用户能以 root 身份执行 shutdown 命令就行了。完全没错，可惜在通常的 Linux 系统中无法实现这一功能，不过已有了工具能实现这样的功能 sudo。<br>sudo 通过维护一个特权到用户名映射的数据库将特权分配给不同的用户，这些特权可由数据库中所列的一些不同的命令来识别。为了获得某一特权项，有资格的用户只需简单地在命令行输入 sudo 和命令名之后，按照提示再次输入口令。例如，sudo 允许普通用户格式化磁盘，不过却没有赋予其他的 root 用户特权。<br>注：<br>sudo 的初衷是：为了让一个普通用户执行 root 的命令。当第一次使用 sudo 的时候会提示输入密码。<br>这个密码是用户自己的密码。<br>不过在 suse 9 和 10 中，使用 sudo 发现输入密码的时候必须输入 root 用户的密码。<br>经过查实发目前 sudo 的设置文件中存在 Defaults targetpw 表示的是 sudo 将提示输入由 sudo 的-u 选项指定的用户(默认为 root)的口令而不是执行 sudo 的用户的口令，如果将其注释掉，那么输入的密码是当前执行用户的。suse 里默认需求输入的是 root 的密码。<br>能这样去理解：你的服务器不允许使用 root 直接 ssh 到服务器或不允许直接使用 root 在 tty 中登录。添加一个用户让他能够 ssh 不过不让他使用 su 命令。这样能使用此方法来让他从事 root 的其中一条命令。<br>sudo 的公式；<br>授权用户 主机=[(转换到哪些用户或用户组)][是否需要密码验证] 命令 1,[(转换到哪些用户或用户组)][是否需要密码验证] [命令 2],[(转换到哪些用户或用户组)][是否需要密码验证] [命令 3]……<br>注：<br>凡是[ ]中的内容，是能省略；命令和命令之间用,号分隔；通过本文的例子，能对照着看哪些是省略了，哪些地方需要有空格；在[(转换到哪些用户或用户组)] ，如果省略，则默认为 root 用户；如果是 ALL ，则代表能转换到所有用户；注意要转换到的目的用户必须用()号括起来，比如(ALL)、(beinan)</p>
<p>1、sudo 工具由文件/etc/sudoers 进行设置，该文件包含所有能访问 sudo 工具的用户列表并定义了他们的特权。一个典型的/etc/sudoers 条目如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zte ALL&#x3D;(ALL) ALL</span><br></pre></td></tr></table></figure>

<p>这个条目使得用户 zte 作为终极用户访问所有应用程式，如用户 zte 需要作为终极用户运行命令，他只需简单地在命令前加上前缀 sudo。因此，要以 root 用户的身份执行命令 ifconfig，zte 能输入如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zte@SMPS-WEB1:&#x2F;home&gt;# sudo &#x2F;usr&#x2F;sbin&#x2F;ifconfig</span><br></pre></td></tr></table></figure>

<p>注意： 执行的 ifconfig 命令要写绝对路径/usr/sbin/ifconfig，/usr/sbin 默认不在普通用户的搜索路径中，或加入此路径：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PATH&#x3D;$PATH:&#x2F;usr&#x2F;sbin;export PATH</span><br></pre></td></tr></table></figure>

<p>另外，不同系统命令的路径不尽相同。能使用命令“whereis 命令名”来查找其路径。<br>ex :</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zte@SMPS-WEB1:&#x2F;home&gt; whereis usermod</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">usermod: &#x2F;usr&#x2F;sbin&#x2F;usermod  &#x2F;usr&#x2F;share&#x2F;man&#x2F;man8&#x2F;usermod.8.gz</span><br></pre></td></tr></table></figure>

<p>这里搜索到 2 个路径，取第一个. 表示在 zte 用户登录下查看 usermod 命令的具体路径<br>这时会显示下面的输出结果：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">We trust you have received the usual lecture from the local System</span><br><span class="line">Administrator. It usually boils down to these two things:</span><br><span class="line">#1) Respect the privacy of others.</span><br><span class="line">#2) Think before you type.</span><br><span class="line">Password:</span><br></pre></td></tr></table></figure>

<p>如果 zte 正确地输入了他的口令，命令 ifconfig 将会以 root 用户身份执行。<br>注意：设置文件/etc/sudoers 必须使用命令 Visudo 来编辑。<br>只要把相应的用户名、主机名和许可的命令列表以标准的格式加入到文件/etc/sudoers，并保存就能生效，再看一个例子。</p>
<p>2、例子：<br>[1]管理员需要允许 gem 用户在主机 sun 上执行 reboot 和 shutdown 命令，在<code>/etc/sudoers</code>中加入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem sun&#x3D;&#x2F;usr&#x2F;sbin&#x2F;reboot，&#x2F;usr&#x2F;sbin&#x2F;shutdown</span><br></pre></td></tr></table></figure>

<p>注意：命令一定要使用绝对路径，以避免其他目录的同名命令被执行，从而造成安全隐患。<br>然后保存退出，gem 用户想执行 reboot 命令时，只要在提示符下运行下列命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo &#x2F;usr&#x2F;sbin&#x2F;reboot</span><br></pre></td></tr></table></figure>

<p>输入正确的密码，就能重启服务器了。<br>[2]<code>beinan ALL=(root) /bin/chown, /bin/chmod</code><br>表示的是 beinan 能在所有可能出现的主机名的主机中，能转换到 root 下执行 /bin/chown ，能转换到所有用户招执行/bin/chmod 命令，通过 sudo -l 来查看 beinan 在这台主机上允许和禁止运行的命令；<br>[3]<code>beinan ALL=(root) NOPASSWD: /bin/chown,/bin/chmod</code><br>表示的是 beinan 能在所有可能出现的主机名的主机中，能转换到 root 下执行 /bin/chown ，不必输入 beinan 用户的密码；并且能转换到所有用户下执行/bin/chmod 命令，但执行 chmod 时需要 beinan 输入自己的密码；通过 sudo -l 来查看 beinan 在这台主机上允许和禁止运行的命令；<br>关于一个命令动作是不是需要密码，我们能发目前系统在默认的情况下是需要用户密码的，除非特加指出不必用户需要输入自己密码，所以要在执行动作之前加入 NOPASSWD: 参数；<br>[4]取消程式某类程式的执行，要在命令动作前面加上!号； 在本例中也出现了通配符的<code>*</code>的用法；<br><code>beinan ALL=/usr/sbin/*,/sbin/*,!/usr/sbin/fdisk</code>注：把这行规则加入到/etc/sudoers 中；但你得有 beinan 这个用户组，并且 beinan 也是这个组中的才行；本规则表示 beinan 用户在 所有可能存在的主机名的主机上运行/usr/sbin 和/sbin 下所有的程式，但 fdisk 程式除外；</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">[beinan@localhost ~]$ sudo -l</span><br><span class="line">Password: 注：在这里输入beinan用户的密码；</span><br><span class="line">User beinan may run the following commands on this host:</span><br><span class="line">(root) &#x2F;usr&#x2F;sbin&#x2F;*</span><br><span class="line">(root) &#x2F;sbin&#x2F;*</span><br><span class="line">(root) !&#x2F;sbin&#x2F;fdisk</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">[beinan@localhost ~]$ sudo &#x2F;sbin&#x2F;fdisk -l</span><br><span class="line">Sorry, user beinan is not allowed to execute ’&#x2F;sbin&#x2F;fdisk -l’ as root on localhost.</span><br></pre></td></tr></table></figure>

<p>注：不能转换到 root 用户下运行 fdisk 程式；<br>[5]如果你想对一组用户进行定义，能在组名前加上<code>%</code>，对其进行设置，如：<br><code>%cuug ALL=(ALL) ALL</code><br>那么属于 cuug 这个组的所有成员都能 sudo 来执行特定的任务</p>
<p>3、另外，还能利用别名来简化设置文件。别名类似组的概念，有用户别名、主机别名和命令别名。多个用户能首先用一个别名来定义，然后在规定他们能执行什么 命令的时候使用别名就能了，这个设置对所有用户都生效。主机别名和命令别名也是如此。注意使用前先要在<code>/etc/sudoers</code>中定义： <code>User_Alias</code>, <code>Host_Alias</code>,<code>Cmnd_Alias</code>项，在其后面加入相应的名称，也以逗号分隔开就能了，举例如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Host_Alias SERVER&#x3D;no1</span><br><span class="line">User_Alias ADMINS&#x3D;liming，gem</span><br><span class="line">Cmnd_Alias</span><br><span class="line">SHUTDOWN&#x3D;&#x2F;usr&#x2F;sbin&#x2F;halt，&#x2F;usr&#x2F;sbin&#x2F;shutdown，&#x2F;usr&#x2F;sbin&#x2F;reboot</span><br><span class="line">ADMINS SERVER&#x3D;SHUTDOWN</span><br></pre></td></tr></table></figure>

<p>4、sudo 命令还能加上一些参数，完成一些辅助的功能，如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo -l</span><br></pre></td></tr></table></figure>

<p>会显示出类似这样的信息：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">User liming may run the following commands on this host:</span><br><span class="line">(root) &#x2F;usr&#x2F;sbin&#x2F;reboot</span><br></pre></td></tr></table></figure>

<p>说明 root 允许用户 liming 执行/usr/sbin/reboot 命令。这个参数能使用户查看自己目前能在 sudo 中执行哪些命令。</p>
<p>5、在命令提示符下键入 sudo 命令会列出所有参数，其他一些参数如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">-V 显示版本编号。</span><br><span class="line">-h 显示sudo命令的使用参数。</span><br><span class="line">-v 因为sudo在第一次执行时或是在N分钟内没有执行（N预设为5）会询问密码。这个参数是重新做一次确认，如果超过N分钟，也会问密码。</span><br><span class="line">-k 将会强迫使用者在下一次执行sudo时询问密码（不论有没有超过N分钟）。</span><br><span class="line">-b 将要执行的命令放在背景执行。</span><br><span class="line">-p prompt 能更改问密码的提示语，其中%u会替换为使用者的账号名称，%h会显示主机名称。</span><br><span class="line">-u username&#x2F;#uid 不加此参数，代表要以root的身份执行命令，而加了此参数，能以username的身份执行命令（#uid为该username的UID）。</span><br><span class="line">-s 执行环境变量中的SHELL所指定的Shell，或是&#x2F;etc&#x2F;passwd里所指定的Shell。</span><br><span class="line">-H 将环境变量中的HOME（宿主目录）指定为要变更身份的使用者的宿主目录。（如不加-u参数就是系统管理者root。）</span><br><span class="line">要以系统管理者身份（或以-u更改为其他人）执行的命令。</span><br></pre></td></tr></table></figure>

<h2 id="用户和用户组应用实例"><a href="#用户和用户组应用实例" class="headerlink" title="用户和用户组应用实例"></a>用户和用户组应用实例</h2><p>建三个用户<code>zte_a</code>,<code>zte_b</code>,<code>zte_c</code> 都所属于 users 组</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">drwxr-xr-x   7 zte_a  users  4096 2007-11-22 09:58 zte_a</span><br><span class="line">drwxr-xr-x   7 zte_b  users  4096 2007-11-22 09:14 zte_b</span><br><span class="line">drwxr-xr-x   7 zte_c  users  4096 2007-11-22 09:14 zte_c</span><br></pre></td></tr></table></figure>

<p>创建 time 目录</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">drwxr-xr-x   2 root   root 4096 2007-11-22 09:26 time</span><br></pre></td></tr></table></figure>

<p>创建 time 目录下的 time 文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-rw-r--r--   1 root root  27 2007-11-22 09:26 time.txt</span><br></pre></td></tr></table></figure>

<p>需求:让 root 用户能 wrx 目录 time 下的 time.txt,同时，而只允许属于 users 用户组的用户读 time.txt 文件</p>
<p>步骤:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">chmod o-r-x time 设置目录权限</span><br><span class="line">drwxr-x---   2 root   root 4096 2007-11-22 09:26 time</span><br><span class="line">chmod o-r time.txt设置文件权限</span><br><span class="line">-rw-r-----   1 root root  27 2007-11-22 09:26 time.txt</span><br><span class="line">chgrp user time 设置目录所属组</span><br><span class="line">drwxr-x---   2 root users 4096 2007-11-22 09:26 time</span><br><span class="line">chgrp user time.txt设置文件所属组</span><br><span class="line">-rw-r-----   1 root users 27 2007-11-22 09:26 time.txt</span><br></pre></td></tr></table></figure>

<p>注: 以后要为 user 组新扩此类用户时，只需 useradd -m new，再 usermod -g user new 将 new 用户归属于 user 组即可</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/linux/" rel="tag"># linux</a>
              <a href="/tags/shell/" rel="tag"># shell</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2016/05/19/gitLab.html" rel="prev" title="gitLab 安装 使用">
      <i class="fa fa-chevron-left"></i> gitLab 安装 使用
    </a></div>
      <div class="post-nav-item">
    <a href="/2016/05/24/Linux%E7%A1%AC%E7%9B%98%E6%93%8D%E4%BD%9C.html" rel="next" title="linux 硬盘操作">
      linux 硬盘操作 <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  

  </div>


          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let activeClass = CONFIG.comments.activeClass;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Linux-用户和用户组管理"><span class="nav-number">1.</span> <span class="nav-text">Linux 用户和用户组管理</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux-用户账号的管理"><span class="nav-number">1.1.</span> <span class="nav-text">Linux 用户账号的管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux-用户口令的管理"><span class="nav-number">1.2.</span> <span class="nav-text">Linux 用户口令的管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Linux-用户组的管理"><span class="nav-number">1.3.</span> <span class="nav-text">Linux 用户组的管理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#和用户账号有关的系统文件"><span class="nav-number">1.4.</span> <span class="nav-text">和用户账号有关的系统文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#su"><span class="nav-number">1.5.</span> <span class="nav-text">su</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#赋予普通用户特别权限-sudo-命令"><span class="nav-number">1.6.</span> <span class="nav-text">赋予普通用户特别权限[sudo 命令]</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#用户和用户组应用实例"><span class="nav-number">1.7.</span> <span class="nav-text">用户和用户组应用实例</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Duan Zhao Qian</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">77</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">6</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">71</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Duan Zhao Qian</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    <span title="站点总字数">393k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">5:57</span>
</div>
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v4.2.0
  </div>
  <span class="post-meta-divider">|</span>
  <div class="theme-info">主题 – <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v7.7.0
  </div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <span class="post-meta-item" id="busuanzi_container_site_uv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-user"></i>
      </span>
      <span class="site-uv" title="总访客量">
        <span id="busuanzi_value_site_uv"></span>
      </span>
    </span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item" id="busuanzi_container_site_pv" style="display: none;">
      <span class="post-meta-item-icon">
        <i class="fa fa-eye"></i>
      </span>
      <span class="site-pv" title="总访问量">
        <span id="busuanzi_value_site_pv"></span>
      </span>
    </span>
</div>








      </div>
    </footer>
  </div>

  
  <script color='0,0,0' opacity='0.5' zIndex='-1' count='99' src="//cdn.jsdelivr.net/gh/theme-next/theme-next-canvas-nest@1/canvas-nest-nomobile.min.js"></script>
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  
  <script>
    (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      bp.src = (curProtocol === 'https') ? 'https://zz.bdstatic.com/linksubmit/push.js' : 'http://push.zhanzhang.baidu.com/push.js';
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
    })();
  </script>




  
<script src="/js/local-search.js"></script>













  

  

</body>
</html>
